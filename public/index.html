<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Real-Debrid Bulk Downloader</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 150px; }
    button { margin-top: 10px; padding: 10px 20px; }
    .result { margin-top: 20px; }
    .link-box { margin-bottom: 15px; }
  </style>
</head>
<body>
  <h2>Real-Debrid Bulk Downloader</h2>
  <textarea id="inputLinks" placeholder="Paste one link per line..."></textarea>
  <br>
  <button onclick="processLinks()">Unrestrict Links</button>

  <div class="result" id="results"></div>

  <script>
    async function processLinks() {
      const input = document.getElementById("inputLinks").value.trim();
      const links = input.split("\n").filter(line => line.trim() !== "");
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = '';

      for (let link of links) {
        const box = document.createElement('div');
        box.className = 'link-box';
        box.textContent = `Processing: ${link}`;

        resultsDiv.appendChild(box);

        try {
          const res = await fetch('/api/unrestrict', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ link })
          });

          const data = await res.json();

          if (data.download) {
            box.innerHTML = `
              <strong>${data.filename}</strong><br>
              <a href="${data.download}" target="_blank">
                <button>Download</button>
              </a>
            `;
          } else {
            box.innerHTML += `<br><span style="color:red;">Failed: ${data.error || 'Unknown error'}</span>`;
          }
        } catch (e) {
          box.innerHTML += `<br><span style="color:red;">Error contacting server</span>`;
        }
      }
    }
  </script>
</body>
</html>
